<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - Sogang Team Building</title>

    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@500;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css">
</head>

<body>

    <header id="main-header"></header>

    <main class="container" style="padding: 3rem 1rem;">

        <div style="display: grid; grid-template-columns: 280px 1fr; gap: 2rem; align-items: start;">

            <!-- Sidebar: Avatar & Basic Info -->
            <div class="card" style="text-align: center; padding: 2rem;">
                <div
                    style="width: 120px; height: 120px; margin: 0 auto 1.5rem; background: #f0f0f0; border-radius: 50%; overflow: hidden; border: 4px solid white; box-shadow: var(--shadow-md);">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="Profile"
                        style="width: 100%; height: 100%;">
                </div>
                <h2 id="display-name" style="font-size: 1.5rem; margin-bottom: 0.25rem;">Student Name</h2>
                <p id="display-major" style="color: var(--color-text-secondary); margin-bottom: 1.5rem;">Major Undefined
                </p>

                <div
                    style="text-align: left; margin-top: 1.5rem; border-top: 1px solid var(--color-border); padding-top: 1.5rem;">
                    <div style="margin-bottom: 0.75rem;">
                        <span
                            style="font-size: 0.85rem; color: var(--color-text-secondary); display: block;">Email</span>
                        <span id="display-email" style="font-weight: 500;">student@sogang.ac.kr</span>
                    </div>
                </div>
            </div>

            <!-- Main Content: Profile Form -->
            <div class="card">
                <div
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; border-bottom: 1px solid var(--color-border); padding-bottom: 1rem;">
                    <h2 style="font-size: 1.5rem;">Profile Settings</h2>
                    <button id="save-btn" class="btn btn-primary">Save Changes</button>
                </div>

                <form id="profile-form">
                    <section style="margin-bottom: 2.5rem;">
                        <h3 style="font-size: 1.1rem; margin-bottom: 1rem;">Academic Info</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                            <div class="input-group">
                                <label class="label">College</label>
                                <select id="college" class="input">
                                    <option value="">Select College</option>
                                    <option value="engineering">Engineering</option>
                                    <option value="science">Natural Sciences</option>
                                    <option value="economics">Economics</option>
                                    <option value="social_sciences">Social Sciences</option>
                                    <option value="media_art">Media & Arts</option>
                                    <option value="humanities">Humanities</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label class="label">Major</label>
                                <input type="text" id="major" class="input" placeholder="e.g. Computer Science">
                            </div>
                        </div>
                    </section>

                    <section style="margin-bottom: 2.5rem;">
                        <h3 style="font-size: 1.1rem; margin-bottom: 1rem;">Roles & Skills</h3>
                        <div class="input-group">
                            <label class="label">Primary Role</label>
                            <select id="primary-role" class="input">
                                <option value="">Select Role</option>
                                <option value="planner">Planner (PM)</option>
                                <option value="designer">Designer (UI/UX)</option>
                                <option value="frontend">Frontend Developer</option>
                                <option value="backend">Backend Developer</option>
                                <option value="data">Data/AI Engineer</option>
                                <option value="media">Media/Video Artist</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label class="label">Skills (comma separated)</label>
                            <input type="text" id="skills" class="input"
                                placeholder="e.g. React, Python, Figma, Premiere Pro">
                            <p style="font-size: 0.8rem; color: var(--color-text-secondary); margin-top: 0.5rem;">These
                                will appear as tags on your profile.</p>
                        </div>
                    </section>

                    <section>
                        <h3 style="font-size: 1.1rem; margin-bottom: 1rem;">Hashtags & Interests</h3>
                        <div class="input-group">
                            <label class="label">Hashtags (#)</label>
                            <input type="text" id="hashtags" class="input"
                                placeholder="#NightOwl #WeekendWarrior #Startup">
                        </div>
                        <div class="input-group">
                            <label class="label">Bio / Introduction</label>
                            <textarea id="bio" class="input" rows="4"
                                placeholder="Briefly introduce yourself and what kind of projects you are looking for..."></textarea>
                        </div>
                    </section>
                </form>
            </div>
        </div>
    </main>

    <footer id="main-footer"></footer>

    <script src="./js/app.js"></script>
    <script>
        // Init Profile Logic
        document.addEventListener('DOMContentLoaded', async () => {
            const currentUser = window.db.getCurrentUser();
            if (!currentUser) {
                window.location.href = './auth/login.html';
                return;
            }

            document.getElementById('display-email').textContent = currentUser.email;
            document.getElementById('display-name').textContent = currentUser.name;

            // Load saved data
            const savedProfile = await window.db.getProfile();
            if (savedProfile) {
                if (savedProfile.college) document.getElementById('college').value = savedProfile.college;
                if (savedProfile.major) {
                    document.getElementById('major').value = savedProfile.major;
                    document.getElementById('display-major').textContent = savedProfile.major;
                }
                if (savedProfile.primaryRole) document.getElementById('primary-role').value = savedProfile.primaryRole;
                if (savedProfile.skills) document.getElementById('skills').value = savedProfile.skills;
                if (savedProfile.hashtags) document.getElementById('hashtags').value = savedProfile.hashtags;
                if (savedProfile.bio) document.getElementById('bio').value = savedProfile.bio;
            }

            // Save Handler
            document.getElementById('save-btn').addEventListener('click', async () => {
                const profileData = {
                    college: document.getElementById('college').value,
                    major: document.getElementById('major').value,
                    primaryRole: document.getElementById('primary-role').value,
                    skills: document.getElementById('skills').value,
                    hashtags: document.getElementById('hashtags').value,
                    bio: document.getElementById('bio').value
                };

                await window.db.updateProfile(profileData);

                // Update UI Feedback
                const btn = document.getElementById('save-btn');
                const originalText = btn.textContent;
                btn.textContent = 'Saved!';
                btn.style.backgroundColor = 'var(--color-accent-teal)';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.backgroundColor = '';
                }, 2000);

                // Update display immediately
                document.getElementById('display-major').textContent = profileData.major || 'Major Undefined';
            });
        });
    </script>
</body>

</html>