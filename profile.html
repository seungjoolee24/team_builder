<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - Sogang Team Building</title>

    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@500;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css">
    <style>
        /* Extra Helper for specific layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        @media (max-width: 600px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>

    <header id="main-header"></header>

    <main class="container" style="padding: 3rem 1rem;">

        <div style="display: grid; grid-template-columns: 280px 1fr; gap: 2rem; align-items: start;">

            <!-- Sidebar -->
            <div class="card" style="text-align: center; padding: 2rem; position: sticky; top: 6rem;">
                <div
                    style="width: 120px; height: 120px; margin: 0 auto 1.5rem; background: #f0f0f0; border-radius: 50%; overflow: hidden; border: 4px solid white; box-shadow: var(--shadow-md);">
                    <img id="profile-avatar" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="Profile"
                        style="width: 100%; height: 100%;">
                </div>
                <h2 id="display-name" style="font-size: 1.5rem; margin-bottom: 0.25rem;">Student Name</h2>
                <p id="display-major" style="color: var(--color-text-secondary); margin-bottom: 1.5rem;">Major Undefined
                </p>

                <div
                    style="text-align: left; margin-top: 1.5rem; border-top: 1px solid var(--color-border); padding-top: 1.5rem;">
                    <div style="margin-bottom: 0.75rem;">
                        <span
                            style="font-size: 0.85rem; color: var(--color-text-secondary); display: block;">Email</span>
                        <span id="display-email" style="font-weight: 500;">student@sogang.ac.kr</span>
                    </div>
                </div>
            </div>

            <!-- Main Content: Profile Form -->
            <div>
                <div
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; padding: 0 0.5rem;">
                    <div>
                        <h2 style="font-size: 1.8rem;">Profile Settings</h2>
                        <p style="color: var(--color-text-secondary); font-size: 0.95rem;">Build your identity to find
                            the perfect team.</p>
                    </div>
                    <button id="save-btn" class="btn btn-primary" style="padding-left: 2rem; padding-right: 2rem;">Save
                        Changes</button>
                </div>

                <form id="profile-form">

                    <!-- 1. Academic & Bio (Required) -->
                    <div class="accordion active">
                        <div class="accordion-header">
                            <h3>Academic & Basic Info <span class="section-tag required">Required</span></h3>
                            <span class="accordion-icon">▼</span>
                        </div>
                        <div class="accordion-content">
                            <div class="grid-2">
                                <div class="input-group">
                                    <label class="label">College</label>
                                    <select id="college" class="input">
                                        <option value="">Select College</option>
                                        <option value="engineering">Engineering</option>
                                        <option value="science">Natural Sciences</option>
                                        <option value="economics">Economics/Business</option>
                                        <option value="social_sciences">Social Sciences</option>
                                        <option value="media_art">Media, Arts & Science (Art&Tech)</option>
                                        <option value="humanities">Humanities</option>
                                        <option value="global">Global Korean Studies</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <label class="label">Major</label>
                                    <input type="text" id="major" class="input" placeholder="e.g. Computer Science">
                                </div>
                            </div>
                            <div class="input-group">
                                <label class="label">Bio / Introduction</label>
                                <textarea id="bio" class="input" rows="3"
                                    placeholder="Briefly introduce yourself..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- 2. Roles & Skills (Required) -->
                    <div class="accordion active">
                        <div class="accordion-header">
                            <h3>Roles & Skills <span class="section-tag required">Required</span></h3>
                            <span class="accordion-icon">▼</span>
                        </div>
                        <div class="accordion-content">
                            <div class="input-group">
                                <label class="label">Primary Role</label>
                                <select id="primaryRole" class="input" required>
                                    <option value="">Choose your main strength</option>
                                    <option value="planner">Planner (PM)</option>
                                    <option value="designer">Designer (UI/UX)</option>
                                    <option value="frontend">Frontend Developer</option>
                                    <option value="backend">Backend Developer</option>
                                    <option value="data">Data/AI Engineer</option>
                                    <option value="media">Media/Video Artist</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="label">Other Roles (Optional)</label>
                                <div class="checkbox-group" id="otherRoles-group">
                                    <label class="checkbox-item"><input type="checkbox" value="planner"> PM</label>
                                    <label class="checkbox-item"><input type="checkbox" value="designer">
                                        Designer</label>
                                    <label class="checkbox-item"><input type="checkbox" value="frontend">
                                        Frontend</label>
                                    <label class="checkbox-item"><input type="checkbox" value="backend"> Backend</label>
                                    <label class="checkbox-item"><input type="checkbox" value="data"> AI/Data</label>
                                    <label class="checkbox-item"><input type="checkbox" value="media"> Media/Art</label>
                                </div>
                            </div>

                            <div class="input-group" style="margin-top: 2rem;">
                                <label class="label">Skills Registry</label>
                                <p style="font-size: 0.85rem; color: var(--color-text-tertiary); margin-bottom: 1rem;">
                                    Select your skills to define your proficiency.</p>

                                <div id="skills-list">
                                    <!-- Dynamic entry rows will go here -->
                                </div>

                                <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                                    <select id="skill-category-add" class="input" style="flex: 1;">
                                        <option value="Programming">Programming Languages</option>
                                        <option value="Frameworks">Frameworks/Libraries</option>
                                        <option value="Design">Design Tools</option>
                                        <option value="Other">Other Tools</option>
                                    </select>
                                    <input type="text" id="skill-name-add" class="input" style="flex: 1.5;"
                                        placeholder="Enter skill name (e.g. Python, React)">
                                    <button type="button" id="add-skill-btn" class="btn btn-secondary">Add
                                        Skill</button>
                                </div>
                                <div id="skill-suggestions"
                                    style="margin-top: 0.5rem; display: flex; flex-wrap: wrap; gap: 0.4rem;">
                                    <!-- Suggestions based on category -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 3. Links (Optional) -->
                    <div class="accordion">
                        <div class="accordion-header">
                            <h3>Links <span class="section-tag optional">Optional</span></h3>
                            <span class="accordion-icon">▼</span>
                        </div>
                        <div class="accordion-content">
                            <div class="grid-2">
                                <div class="input-group">
                                    <label class="label">GitHub</label>
                                    <input type="text" id="link-github" class="input"
                                        placeholder="https://github.com/...">
                                </div>
                                <div class="input-group">
                                    <label class="label">Portfolio</label>
                                    <input type="text" id="link-portfolio" class="input"
                                        placeholder="Personal website link">
                                </div>
                                <div class="input-group">
                                    <label class="label">YouTube</label>
                                    <input type="text" id="link-youtube" class="input"
                                        placeholder="YouTube channel link">
                                </div>
                                <div class="input-group">
                                    <label class="label">Instagram</label>
                                    <input type="text" id="link-instagram" class="input" placeholder="@handle or link">
                                </div>
                            </div>

                            <!-- Custom Links -->
                            <div class="input-group"
                                style="margin-top: 1.5rem; border-top: 1px solid var(--color-border); padding-top: 1.5rem;">
                                <label class="label">Custom Links</label>
                                <div id="custom-links-container"
                                    style="display: flex; flex-direction: column; gap: 0.75rem; margin-bottom: 1rem;">
                                    <!-- Dynamic links injected here -->
                                </div>

                                <div style="display: flex; gap: 0.5rem;">
                                    <input type="text" id="custom-link-label" class="input" style="flex: 1;"
                                        placeholder="Label (e.g. Notion)">
                                    <input type="text" id="custom-link-url" class="input" style="flex: 2;"
                                        placeholder="URL (https://...)">
                                    <button type="button" id="add-link-btn" class="btn btn-secondary">Add</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 4. Detailed Tags (Unified System) -->
                    <div class="accordion active">
                        <div class="accordion-header">
                            <h3>Detailed Profile Tags <span class="section-tag required">Recommended</span></h3>
                            <span class="accordion-icon">▼</span>
                        </div>
                        <div class="accordion-content">
                            <p style="color: var(--color-text-secondary); margin-bottom: 1.5rem; font-size: 0.9rem;">
                                Select tags that describe your interests, work style, and goals. These tags are used to
                                recommend you to teammates.
                            </p>

                            <!-- Selected Tags Display -->
                            <div style="margin-bottom: 2rem;">
                                <label class="label">My Tags</label>
                                <div id="my-tags-container" class="chips-container"
                                    style="min-height: 40px; padding: 0.5rem; background: #f8f9fa; border: 1px solid var(--color-border); border-radius: 8px;">
                                    <!-- Selected tags go here -->
                                </div>
                                <input type="text" id="manual-tag-input" class="input" style="margin-top: 0.5rem;"
                                    placeholder="Type custom tag and press Enter...">
                            </div>

                            <!-- Predefined Categories -->
                            <div id="predefined-tags-area">
                                <!-- Injected via JS -->
                            </div>
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </main>

    <footer id="main-footer"></footer>

    <script src="./js/app.js"></script>
    <script>
        const PREDEFINED_TAG_CATEGORIES = {
            'Interest': [
                'Web/App', 'AI/Data', 'Fintech', 'Game Dev', 'Blockchain', 'E-commerce',
                'IoT', 'Metaverse', 'Cloud Computing', 'Security', 'Healthcare', 'EdTech',
                'Social Media', 'Enterprise', 'SaaS', 'Mobile'
            ],
            'Preference': [
                'Competition', 'Side Project', 'Startup', 'Study Group', 'Hackathon',
                'Capstone', 'Research', 'Volunteering', 'Freelance'
            ],
            'Collaboration': [
                'Less than 5h/week', '5-10h/week', '10-20h/week', '20h+/week',
                'Online Only', 'Offline Preferred', 'Hybrid', 'Flexible Hours',
                'Fixed Schedule', 'Weekends Only', 'Weekdays Only',
                'Short-term (1mo)', 'Mid-term (3mo)', 'Long-term (6mo+)'
            ],
            'Availability': [
                'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday',
                'Saturday', 'Sunday', 'Morning', 'Afternoon', 'Evening', 'Late Night'
            ],
            'Goals': [
                'Win Awards', 'Build Portfolio', 'Networking', 'Learn New Tech',
                'Launch Product', 'Get Hired', 'Have Fun', 'Solve Real Problem'
            ],
            'Motivation': [
                'High Passion', 'Serious & Committed', 'Just Experience',
                'Chill / Casual', 'Growth Mindset', 'Leadership', 'Team Player'
            ]
        };

        const state = {
            skills: [],
            tags: new Set(),
            customLinks: []
        };

        // ... existing setup ...

        // --- UI Initialize ---
        setupAccordions();
        setupSkillSystem();
        setupLinkSystem();
        setupTagSystem();

        // ... existing load/save ...

        function setupLinkSystem() {
            const addBtn = document.getElementById('add-link-btn');
            const labelInput = document.getElementById('custom-link-label');
            const urlInput = document.getElementById('custom-link-url');

            addBtn.addEventListener('click', () => {
                const label = labelInput.value.trim();
                const url = urlInput.value.trim();

                if (!label || !url) return alert('Please enter both label and URL');

                addLinkToUI({ label, url });
                labelInput.value = '';
                urlInput.value = '';
            });

            window.removeLink = (index) => {
                state.customLinks.splice(index, 1);
                renderCustomLinks();
            };
        }

        function addLinkToUI(link) {
            state.customLinks.push(link);
            renderCustomLinks();
        }

        function renderCustomLinks() {
            const container = document.getElementById('custom-links-container');
            container.innerHTML = state.customLinks.map((link, index) => `
                <div style="display: flex; gap: 0.5rem; align-items: center; background: var(--color-bg-secondary); padding: 0.5rem; border-radius: 4px;">
                    <span style="font-weight: 600; font-size: 0.9rem; min-width: 80px;">${link.label}</span>
                    <a href="${link.url}" target="_blank" style="flex: 1; font-size: 0.85rem; color: var(--color-primary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${link.url}</a>
                    <button type="button" onclick="removeLink(${index})" style="background: none; border: none; cursor: pointer; font-size: 1.2rem; color: var(--color-text-tertiary);">&times;</button>
                </div>
            `).join('');
        }

        // ... setupTagSystem ...

        function collectFormData() {
            // ... existing skills ...
            const getChecked = (selector) => Array.from(document.querySelectorAll(`${selector} input:checked`)).map(i => i.value);

            return {
                college: document.getElementById('college').value,
                major: document.getElementById('major').value,
                bio: document.getElementById('bio').value,
                primaryRole: document.getElementById('primaryRole').value,
                otherRoles: getChecked('#otherRoles-group'),
                skills: state.skills,
                links: {
                    github: document.getElementById('link-github').value,
                    portfolio: document.getElementById('link-portfolio').value,
                    youtube: document.getElementById('link-youtube').value,
                    instagram: document.getElementById('link-instagram').value
                },
                customLinks: state.customLinks, // Send custom links
                tags: Array.from(state.tags)
            };
        }

        function fillFormData(p) {
            // ... basics ...
            if (p.college) document.getElementById('college').value = p.college;
            if (p.major) {
                document.getElementById('major').value = p.major;
                document.getElementById('display-major').textContent = p.major;
            }
            if (p.bio) document.getElementById('bio').value = p.bio;
            if (p.primaryRole) document.getElementById('primaryRole').value = p.primaryRole;

            // ... checkboxes logic ...
            if (p.otherRoles) {
                p.otherRoles.forEach(val => {
                    const cb = document.querySelector(`#otherRoles-group input[value="${val}"]`);
                    if (cb) cb.checked = true;
                });
            }

            // Skills
            if (p.skills && Array.isArray(p.skills)) {
                p.skills.forEach(s => addSkillToUI(s));
            }

            // Links
            if (p.links) {
                document.getElementById('link-github').value = p.links.github || '';
                document.getElementById('link-portfolio').value = p.links.portfolio || '';
                document.getElementById('link-youtube').value = p.links.youtube || '';
                document.getElementById('link-instagram').value = p.links.instagram || '';
            }

            // Custom Links
            if (p.customLinks && Array.isArray(p.customLinks)) {
                p.customLinks.forEach(l => addLinkToUI(l));
            }

            // Tags
            if (p.tags && Array.isArray(p.tags)) {
                p.tags.forEach(t => state.tags.add(t));
                renderMyTags();
            }
        }

        function showSuccessFeedback() {
            const btn = document.getElementById('save-btn');
            const originalText = btn.textContent;
            btn.textContent = 'Saved!';
            btn.style.backgroundColor = 'var(--color-accent-teal)';
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.backgroundColor = '';
            }, 2000);
        }
    </script>
</body>

</html>